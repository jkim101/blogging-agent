{% extends "base.html" %}
{% block title %}New Pipeline â€” Blogging Agent{% endblock %}
{% block content %}
<h1>New Pipeline</h1>

{% if error %}
<p class="error">{{ error }}</p>
{% endif %}

<form method="post" action="/pipeline/start" enctype="multipart/form-data">
    <fieldset>
        <legend>URL Sources</legend>
        <div id="url-inputs">
            <div class="source-input">
                <input type="url" name="urls" placeholder="https://example.com/article">
            </div>
        </div>
        <button type="button" onclick="addInput('url-inputs', 'urls', 'url', 'https://example.com/article')">+ Add URL</button>
    </fieldset>

    <fieldset>
        <legend>YouTube Videos</legend>
        <div id="youtube-inputs">
            <div class="source-input">
                <input type="url" name="youtube_urls" placeholder="https://www.youtube.com/watch?v=VIDEO_ID">
            </div>
        </div>
        <button type="button" onclick="addInput('youtube-inputs', 'youtube_urls', 'url', 'https://www.youtube.com/watch?v=VIDEO_ID')">+ Add YouTube</button>
    </fieldset>

    <fieldset>
        <legend>PDF Files</legend>
        <div id="pdf-inputs">
            <div class="source-input">
                <input type="file" name="pdfs" accept=".pdf">
            </div>
        </div>
        <button type="button" onclick="addFileInput('pdf-inputs')">+ Add PDF</button>
    </fieldset>

    <button type="submit" class="btn-primary">Start Pipeline</button>
</form>

<script>
function addInput(containerId, name, type, placeholder) {
    const container = document.getElementById(containerId);
    const div = document.createElement('div');
    div.className = 'source-input';
    div.innerHTML = `<input type="${type}" name="${name}" placeholder="${placeholder}">`;
    container.appendChild(div);
}
function addFileInput(containerId) {
    const container = document.getElementById(containerId);
    const div = document.createElement('div');
    div.className = 'source-input';
    div.innerHTML = '<input type="file" name="pdfs" accept=".pdf">';
    container.appendChild(div);
}
</script>
{% endblock %}
